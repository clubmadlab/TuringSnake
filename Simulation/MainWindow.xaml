<Window x:Class="TuringMachine.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:TuringMachine"
        mc:Ignorable="d"
        Title="Turing Snake Turing Machine" Width="1200" Height="800" WindowStartupLocation="CenterScreen" Loaded="Window_Loaded" SizeChanged="Window_SizeChanged"
          Closing="Window_Closing">
    <Window.InputBindings>
        <KeyBinding Key="N" Modifiers="Ctrl" Command="local:MainWindow.NewCommand"/>
        <KeyBinding Key="L" Modifiers="Ctrl" Command="local:MainWindow.LoadCommand"/>
        <KeyBinding Key="S" Modifiers="Ctrl" Command="local:MainWindow.SaveCommand"/>
        <KeyBinding Key="R" Modifiers="Ctrl" Command="local:MainWindow.ReloadCommand"/>
        <KeyBinding Key="Esc" Command="local:MainWindow.EscCommand"/>
        <KeyBinding Key="F1" Command="local:MainWindow.F1Command"/>
        <KeyBinding Key="F5" Command="local:MainWindow.F5Command"/>
        <KeyBinding Key="F6" Command="local:MainWindow.F6Command"/>
        <KeyBinding Key="F7" Command="local:MainWindow.F7Command"/>
    </Window.InputBindings>
    <Window.Resources>
        <Style TargetType="Button">
            <Setter Property="Width" Value="30"/>
            <Setter Property="Height" Value="30"/>
            <Setter Property="Margin" Value="6,4,0,4"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="BorderBrush" Value="SlateGray"/>
            <Setter Property="Background" Value="WhiteSmoke"/>
            <Setter Property="FontWeight" Value="Bold"/>
        </Style>
    </Window.Resources>
    <DockPanel LastChildFill="True">
        <Menu DockPanel.Dock="Top" Height="25" Background="AliceBlue">
            <MenuItem Name="FileMenu" Header="_File">
                <MenuItem Header="_New program" InputGestureText="Ctrl+N" Command="local:MainWindow.NewCommand">
                    <MenuItem.Icon>
                        <Image Source="New.png"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="_Load program" InputGestureText="Ctrl+L" Command="local:MainWindow.LoadCommand">
                    <MenuItem.Icon>
                        <Image Source="Load.png"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="_Save program" InputGestureText="Ctrl+S" Command="local:MainWindow.SaveCommand">
                    <MenuItem.Icon>
                        <Image Source="Save.png"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Save _as..." Click="SaveAs_Click">
                    <MenuItem.Icon>
                        <Image Source="SaveAs.png"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="_Reload program" InputGestureText="Ctrl+R" Command="local:MainWindow.ReloadCommand"/>
                <Separator/>
                <MenuItem Header="E_xit" Click="Exit_Click">
                    <MenuItem.Icon>
                        <Image Source="Close.png"/>
                    </MenuItem.Icon>
                </MenuItem>
                <Separator Name="FileHistory"/>
                <MenuItem Header="" Tag="1" Click="History_Click"/>
                <MenuItem Header="" Tag="2" Click="History_Click"/>
                <MenuItem Header="" Tag="3" Click="History_Click"/>
                <MenuItem Header="" Tag="4" Click="History_Click"/>
                <MenuItem Header="" Tag="5" Click="History_Click"/>
                <MenuItem Header="" Tag="6" Click="History_Click"/>
            </MenuItem>
            <MenuItem Header="_Run">
                <MenuItem Header="Rese_t" InputGestureText="F5" Click="Reset_Click">
                    <MenuItem.Icon>
                        <Canvas>
                            <Path Stroke="CornflowerBlue" StrokeThickness="4">
                                <Path.Data>
                                    <GeometryGroup>
                                        <PathGeometry Figures="M 18,13 A 8,8 320 1 1 19,8"/>
                                        <PathGeometry Figures="M 22,10 L 22,1"/>
                                        <PathGeometry Figures="M 24,9 L 14,9"/>
                                    </GeometryGroup>
                                </Path.Data>
                            </Path>
                            <Canvas.RenderTransform>
                                <ScaleTransform ScaleX="0.7" ScaleY="0.7"/>
                            </Canvas.RenderTransform>
                        </Canvas>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="_Run/Pause" InputGestureText="F6" Click="Run_Click">
                    <MenuItem.Icon>
                        <Canvas>
                            <Grid>
                                <Path Name="StartMenuIcon" StrokeThickness="0" Fill="CornflowerBlue" Data="M 1,0 L 1,20 L 20,10" Visibility="Visible"/>
                                <Path Name="PauseMenuIcon" StrokeThickness="0" Fill="CornflowerBlue" Data="M 3,0 L 3,20 L 8,20 L 8,0 M 13,0 L 13,20 L 18,20 L 18,0" Visibility="Hidden"/>
                            </Grid>
                            <Canvas.RenderTransform>
                                <ScaleTransform ScaleX="0.7" ScaleY="0.7"/>
                            </Canvas.RenderTransform>
                        </Canvas>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="_Step" InputGestureText="F7" Click="Step_Click">
                    <MenuItem.Icon>
                        <Canvas>
                            <Grid>
                                <Path StrokeThickness="0" Fill="CornflowerBlue" Data="M 1,0 L 1,20 L 20,10"/>
                                <Path StrokeThickness="0" Fill="CornflowerBlue" Data="M 15,0 L 15,20 L 20,20 L 20,0"/>
                            </Grid>
                            <Canvas.RenderTransform>
                                <ScaleTransform ScaleX="0.7" ScaleY="0.7"/>
                            </Canvas.RenderTransform>
                        </Canvas>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
            <MenuItem Name="ToolsMenu" Header="_Tools">
                <MenuItem Header="_Upload program" Click="UploadMenuItem_Click"/>
                <MenuItem Header="_Store program in flash memory" Click="StoreMenuItem_Click"/>
                <MenuItem Header="_Reconnect serial port" Click="ReconnectMenuItem_Click"/>
            </MenuItem>
            <MenuItem Header="_Options" SubmenuOpened="Options_SubmenuOpened">
                <MenuItem Name="DarkModeMenuItem" Header="_Dark mode" IsCheckable="True" Click="DarkMode_Click"/>
                <MenuItem Name="SyntaxHighlightingMenuItem" Header="_Syntax highlighting" IsCheckable="True" Click="SyntaxHighlighting_Click"/>
                <MenuItem Name="RepeatStepMenuItem" Header="_Repeat step until wait" IsCheckable="True" Click="RepeatStep_Click"/>
                <MenuItem Name="ClockSpeedMenuItem" Header="_Clock speed">
                    <MenuItem Header="1 instruction/second" Tag="1" Click="ClockSpeed_Click"/>
                    <MenuItem Header="2 instructions/second" Tag="2" Click="ClockSpeed_Click"/>
                    <MenuItem Header="5 instructions/second" Tag="5" Click="ClockSpeed_Click"/>
                    <MenuItem Header="10 instructions/second" Tag="10" Click="ClockSpeed_Click"/>
                    <MenuItem Header="20 instructions/second" Tag="20" Click="ClockSpeed_Click"/>
                    <MenuItem Header="40 instructions/second" Tag="40" Click="ClockSpeed_Click"/>
                </MenuItem>
                <MenuItem Name="TapeheadHighlightingMenuItem" Header="_Tapehead highlighting" IsCheckable="True" Click="TapeheadHighlighting_Click"/>
            </MenuItem>
            <MenuItem Header="_Help">
                <MenuItem Header="Instructions" InputGestureText="F1" Click="Instructions_Click">
                    <MenuItem.Icon>
                        <Image Source="Help.png"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="_About" Click="About_Click">
                    <MenuItem.Icon>
                        <Image Source="About.png"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
        </Menu>
        <StatusBar DockPanel.Dock="Bottom" HorizontalAlignment="Stretch" Height="28">
            <StatusBarItem>
                <TextBlock x:Name="StatusMessage" Width="300" Margin="10,0,0,0"/>
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <TextBlock x:Name="InstrMessage" Width="300" Margin="0,0,0,0"/>
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <TextBlock x:Name="PositionMessage" Width="100" Margin="0,0,10,0"/>
            </StatusBarItem>
        </StatusBar>
        <Canvas Name="background" Background="White">
            <StackPanel Orientation="Vertical" HorizontalAlignment="Left">
                <Canvas Name="tape" Height="430" Background="Transparent" HorizontalAlignment="Left"/>
                <Border Name="outline" Width="1100" Height="200" BorderBrush="Black" BorderThickness="2" HorizontalAlignment="Left" Margin="50,0,0,0">
                    <DockPanel LastChildFill="True">
                        <StatusBar DockPanel.Dock="Top" HorizontalAlignment="Stretch" Background="AliceBlue">
                            <StatusBarItem>
                                <Button Content="&lt;" Tag="&lt;" ToolTip="&lt; - move one square to the left or &lt;n - move n squares left" Click="Button_Click"/>
                            </StatusBarItem>
                            <StatusBarItem>
                                <Button Content="&lt;&lt;" Tag="&lt;&lt;" ToolTip="&lt;&lt; - move to the first square" Click="Button_Click"/>
                            </StatusBarItem>
                            <StatusBarItem>
                                <Button Content="&gt;" Tag="&gt;" ToolTip="&gt; - move one square to the right or &gt;n - move n squares right" Click="Button_Click"/>
                            </StatusBarItem>
                            <StatusBarItem>
                                <Button Content="&gt;&gt;" Tag="&gt;&gt;" ToolTip="&gt;&gt; - move to the last square" Click="Button_Click"/>
                            </StatusBarItem>
                            <StatusBarItem>
                                <Button Content="$" Tag="$" ToolTip="$variable=expression - assign value to variable (lower case)" Click="Button_Click"/>
                            </StatusBarItem>
                            <StatusBarItem>
                                <Button Content="++" Tag="++" ToolTip="$variable++ - increment variable" Click="Button_Click"/>
                            </StatusBarItem>
                            <StatusBarItem>
                                <Button Content="--" Tag="--" ToolTip="$variable-- - decrement variable" Click="Button_Click"/>
                            </StatusBarItem>
                            <StatusBarItem>
                                <Button Content="?" Tag="?" ToolTip="?, ?!, ?&gt;, ?&gt;=, ?&lt;, ?&lt;= expression action - conditional test" Click="Button_Click"/>
                            </StatusBarItem>
                            <StatusBarItem>
                                <Button Content="#" Tag="#" ToolTip="#label - define label (lower case)" Click="Button_Click"/>
                            </StatusBarItem>
                            <StatusBarItem>
                                <Button Content="^" Tag="^" ToolTip="^label - branch to label" Click="Button_Click"/>
                            </StatusBarItem>
                            <StatusBarItem>
                                <Button Content="%" Tag="%" ToolTip="%n - wait n periods" Click="Button_Click"/>
                            </StatusBarItem>
                            <StatusBarItem>
                                <Button Content="R" Tag="R" Foreground="Red" ToolTip="R - change current square to red" Click="Button_Click"/>
                            </StatusBarItem>
                            <StatusBarItem>
                                <Button Content="G" Tag="G" Foreground="Green" ToolTip="G - change current square to green" Click="Button_Click"/>
                            </StatusBarItem>
                            <StatusBarItem>
                                <Button Content="B" Tag="B" Foreground="Blue" ToolTip="B - change current square to blue" Click="Button_Click"/>
                            </StatusBarItem>
                            <StatusBarItem>
                                <Button Content="C" Tag="C" Foreground="Cyan" ToolTip="C - change current square to cyan" Click="Button_Click"/>
                            </StatusBarItem>
                            <StatusBarItem>
                                <Button Content="M" Tag="M" Foreground="Magenta" ToolTip="M - change current square to magenta" Click="Button_Click"/>
                            </StatusBarItem>
                            <StatusBarItem>
                                <Button Content="Y" Tag="Y" Foreground="Yellow" ToolTip="Y - change current square to yellow" Click="Button_Click"/>
                            </StatusBarItem>
                            <StatusBarItem>
                                <Button Content="W" Tag="W" Foreground="Gray" ToolTip="W - change current square to white" Click="Button_Click"/>
                            </StatusBarItem>
                            <StatusBarItem>
                                <Button Content="K" Tag="K" ToolTip="K - change current square to black (clear square)" Click="Button_Click"/>
                            </StatusBarItem>
                            <StatusBarItem>
                                <Button Content=";" Tag=";" ToolTip="comment, until end of line" Click="Button_Click"/>
                            </StatusBarItem>
                        </StatusBar>
                        <RichTextBox Name="editor" Margin="5,5,5,5" BorderThickness="0" BorderBrush="Transparent" Background="White" FontSize="20"
                          FocusVisualStyle="{x:Null}" Block.LineHeight="1" AcceptsReturn="True" AcceptsTab="True" TextChanged="editor_TextChanged"
                          SelectionChanged="editor_SelectionChanged"/>
                    </DockPanel>
                </Border>
                <StackPanel Name="transport" Orientation="Horizontal" HorizontalAlignment="Left" Margin="490,25,0,0" Background="Transparent">
                    <Button Width="60" Margin="0,0,20,0" ToolTip="Reset" FocusVisualStyle="{x:Null}" Click="Reset_Click">
                        <Path Stroke="CornflowerBlue" StrokeThickness="4">
                            <Path.Data>
                                <GeometryGroup>
                                    <PathGeometry Figures="M 18,13 A 8,8 320 1 1 19,8"/>
                                    <PathGeometry Figures="M 22,10 L 22,1"/>
                                    <PathGeometry Figures="M 24,9 L 14,9"/>
                                </GeometryGroup>
                            </Path.Data>
                        </Path>
                        <Button.Resources>
                            <Style TargetType="Border">
                                <Setter Property="CornerRadius" Value="10"/>
                            </Style>
                        </Button.Resources>
                    </Button>
                    <Button Width="60" Margin="0,0,0,0" ToolTip="Run/Pause" FocusVisualStyle="{x:Null}" Click="Run_Click">
                        <Grid>
                            <Path Name="StartButtonIcon" StrokeThickness="0" Fill="CornflowerBlue" Data="M 1,0 L 1,20 L 20,10" Visibility="Visible"/>
                            <Path Name="PauseButtonIcon" StrokeThickness="0" Fill="CornflowerBlue" Data="M 3,0 L 3,20 L 8,20 L 8,0 M 13,0 L 13,20 L 18,20 L 18,0" Visibility="Hidden"/>
                        </Grid>
                        <Button.Resources>
                            <Style TargetType="Border">
                                <Setter Property="CornerRadius" Value="10"/>
                            </Style>
                        </Button.Resources>
                    </Button>
                    <Button Width="60" Margin="20,0,0,0" ToolTip="Single step" FocusVisualStyle="{x:Null}" Click="Step_Click">
                        <Grid>
                            <Path StrokeThickness="0" Fill="CornflowerBlue" Data="M 1,0 L 1,20 L 20,10"/>
                            <Path StrokeThickness="0" Fill="CornflowerBlue" Data="M 15,0 L 15,20 L 20,20 L 20,0"/>
                        </Grid>
                        <Button.Resources>
                            <Style TargetType="Border">
                                <Setter Property="CornerRadius" Value="10"/>
                            </Style>
                        </Button.Resources>
                    </Button>
                </StackPanel>
            </StackPanel>
        </Canvas>
    </DockPanel>
</Window>
